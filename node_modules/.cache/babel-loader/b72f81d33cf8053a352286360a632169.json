{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState } from 'react';\nexport const useCurrentLocation = (options, callback) => {\n  _s();\n\n  // store location in state\n  const [location, setLocation] = useState(); // store error message in state\n\n  const [error, setError] = useState();\n  const [cityInfo, setCityInfo] = useState({});\n\n  const getCityName = async ({\n    latitude,\n    longitude\n  }) => {\n    try {\n      const response = await axios.get(`https://api.opencagedata.com/geocode/v1/json?q=${latitude}+${longitude}&key=${OPEN_CAGE_DATA_KEY}`);\n      console.log(response.data.results[0]);\n\n      if (response.data.results[0]) {\n        setCityInfo({\n          city: response.data.results[0].components.village,\n          label: response.data.results[0].annotations.flag\n        });\n      }\n    } catch (err) {\n      if (OPEN_WEATHER_MAP_KEY.length === 0) {\n        // Use mock data if no key\n        // const transformData = await testData.list.map((data) => ({\n        //   dt: data.dt,\n        //   temp: data.main.temp,\n        //   temp_min: data.main.temp_min,\n        //   temp_max: data.main.temp_max,\n        //   humidity: data.main.humidity,\n        //   icon: data.weather[0].icon,\n        //   desc: data.weather[0].description,\n        //   clouds: data.clouds.all,\n        //   wind: data.wind.speed,\n        // }));\n        setError('');\n      } else {\n        setError(err.stack);\n      }\n    }\n  }; // Success handler for geolocation's `getCurrentPosition` method\n\n\n  const handleSuccess = position => {\n    const {\n      latitude,\n      longitude\n    } = position.coords;\n    setLocation({\n      latitude,\n      longitude\n    });\n    getCityName({\n      latitude,\n      longitude\n    });\n  }; // Error handler for geolocation's `getCurrentPosition` method\n\n\n  const handleError = error => {\n    setError(error.message);\n  }; // ...\n\n\n  if (!navigator.geolocation) {\n    console.log('Geolocation is not supported by your browser');\n  } else {\n    console.log('Locating…');\n    navigator.geolocation.getCurrentPosition(handleSuccess, handleError, options);\n  } // Expose location result and the possible error message\n\n\n  return {\n    location,\n    error,\n    cityInfo\n  };\n};\n\n_s(useCurrentLocation, \"SiHmzt1VL9PuB9k/ZbRdQUVO+FA=\");","map":{"version":3,"sources":["/Users/yujiaguo/Documents/github/weather-widget/src/hooks/useCurrentLocation.js"],"names":["useState","useCurrentLocation","options","callback","location","setLocation","error","setError","cityInfo","setCityInfo","getCityName","latitude","longitude","response","axios","get","OPEN_CAGE_DATA_KEY","console","log","data","results","city","components","village","label","annotations","flag","err","OPEN_WEATHER_MAP_KEY","length","stack","handleSuccess","position","coords","handleError","message","navigator","geolocation","getCurrentPosition"],"mappings":";;AAAA,SAASA,QAAT,QAAyB,OAAzB;AAEA,OAAO,MAAMC,kBAAkB,GAAG,CAACC,OAAD,EAASC,QAAT,KAAsB;AAAA;;AACtD;AACA,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BL,QAAQ,EAAxC,CAFsD,CAGtD;;AACA,QAAM,CAACM,KAAD,EAAQC,QAAR,IAAoBP,QAAQ,EAAlC;AACA,QAAM,CAACQ,QAAD,EAAWC,WAAX,IAA0BT,QAAQ,CAAC,EAAD,CAAxC;;AAEA,QAAMU,WAAW,GAAG,OAAO;AAAEC,IAAAA,QAAF;AAAYC,IAAAA;AAAZ,GAAP,KAAmC;AACrD,QAAI;AACF,YAAMC,QAAQ,GAAG,MAAMC,KAAK,CAACC,GAAN,CAAY,kDAAiDJ,QAAS,IAAGC,SAAU,QAAOI,kBAAmB,EAA7G,CAAvB;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYL,QAAQ,CAACM,IAAT,CAAcC,OAAd,CAAsB,CAAtB,CAAZ;;AACA,UAAGP,QAAQ,CAACM,IAAT,CAAcC,OAAd,CAAsB,CAAtB,CAAH,EAA6B;AAC3BX,QAAAA,WAAW,CAAC;AAACY,UAAAA,IAAI,EAAER,QAAQ,CAACM,IAAT,CAAcC,OAAd,CAAsB,CAAtB,EAAyBE,UAAzB,CAAoCC,OAA3C;AAAoDC,UAAAA,KAAK,EAAEX,QAAQ,CAACM,IAAT,CAAcC,OAAd,CAAsB,CAAtB,EAAyBK,WAAzB,CAAqCC;AAAhG,SAAD,CAAX;AACD;AACF,KAND,CAME,OAAOC,GAAP,EAAY;AACZ,UAAIC,oBAAoB,CAACC,MAArB,KAAgC,CAApC,EAAuC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAtB,QAAAA,QAAQ,CAAC,EAAD,CAAR;AACD,OAdD,MAcO;AACLA,QAAAA,QAAQ,CAACoB,GAAG,CAACG,KAAL,CAAR;AACD;AACF;AACF,GA1BD,CAPsD,CAkCtD;;;AACA,QAAMC,aAAa,GAAGC,QAAQ,IAAI;AAChC,UAAM;AAAErB,MAAAA,QAAF;AAAYC,MAAAA;AAAZ,QAA0BoB,QAAQ,CAACC,MAAzC;AAEA5B,IAAAA,WAAW,CAAC;AACVM,MAAAA,QADU;AAEVC,MAAAA;AAFU,KAAD,CAAX;AAIAF,IAAAA,WAAW,CAAC;AACVC,MAAAA,QADU;AAEVC,MAAAA;AAFU,KAAD,CAAX;AAID,GAXD,CAnCsD,CAgDtD;;;AACA,QAAMsB,WAAW,GAAG5B,KAAK,IAAI;AAC3BC,IAAAA,QAAQ,CAACD,KAAK,CAAC6B,OAAP,CAAR;AACD,GAFD,CAjDsD,CAoDtD;;;AAEA,MAAG,CAACC,SAAS,CAACC,WAAd,EAA2B;AACrBpB,IAAAA,OAAO,CAACC,GAAR,CAAY,8CAAZ;AACH,GAFH,MAES;AACHD,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACAkB,IAAAA,SAAS,CAACC,WAAV,CAAsBC,kBAAtB,CAAyCP,aAAzC,EAAwDG,WAAxD,EAAqEhC,OAArE;AACH,GA3DmD,CA4DtD;;;AACA,SAAO;AAAEE,IAAAA,QAAF;AAAYE,IAAAA,KAAZ;AAAmBE,IAAAA;AAAnB,GAAP;AACD,CA9DM;;GAAMP,kB","sourcesContent":["import { useState } from 'react';\n\nexport const useCurrentLocation = (options,callback) => {\n  // store location in state\n  const [location, setLocation] = useState();\n  // store error message in state\n  const [error, setError] = useState();\n  const [cityInfo, setCityInfo] = useState({});\n\n  const getCityName = async ({ latitude, longitude }) => {\n    try {\n      const response = await axios.get( `https://api.opencagedata.com/geocode/v1/json?q=${latitude}+${longitude}&key=${OPEN_CAGE_DATA_KEY}`);\n      console.log(response.data.results[0]);\n      if(response.data.results[0]) {\n        setCityInfo({city: response.data.results[0].components.village, label: response.data.results[0].annotations.flag});\n      }\n    } catch (err) {\n      if (OPEN_WEATHER_MAP_KEY.length === 0) {\n        // Use mock data if no key\n        // const transformData = await testData.list.map((data) => ({\n        //   dt: data.dt,\n        //   temp: data.main.temp,\n        //   temp_min: data.main.temp_min,\n        //   temp_max: data.main.temp_max,\n        //   humidity: data.main.humidity,\n        //   icon: data.weather[0].icon,\n        //   desc: data.weather[0].description,\n        //   clouds: data.clouds.all,\n        //   wind: data.wind.speed,\n        // }));\n        setError('');\n      } else {\n        setError(err.stack);\n      }\n    }\n  }\n  // Success handler for geolocation's `getCurrentPosition` method\n  const handleSuccess = position => {\n    const { latitude, longitude } = position.coords;\n\n    setLocation({\n      latitude,\n      longitude\n    });\n    getCityName({\n      latitude,\n      longitude\n    })\n  };\n\n  // Error handler for geolocation's `getCurrentPosition` method\n  const handleError = error => {\n    setError(error.message);\n  };\n  // ...\n\n  if(!navigator.geolocation) {\n        console.log('Geolocation is not supported by your browser');\n    } else {\n        console.log('Locating…');\n        navigator.geolocation.getCurrentPosition(handleSuccess, handleError, options);\n    }    \n  // Expose location result and the possible error message\n  return { location, error, cityInfo };\n}"]},"metadata":{},"sourceType":"module"}